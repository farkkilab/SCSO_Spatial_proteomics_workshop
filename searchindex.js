Search.setIndex({"docnames": ["README", "exercise1", "exercise2", "exercise3", "exercise4", "index"], "filenames": ["README.md", "exercise1.md", "exercise2.md", "exercise3.ipynb", "exercise4.ipynb", "index.md"], "titles": ["Spatial Proteomics Workshop 2026", "Exercise 1: Technical foundations of digital pathology", "Exercise 2: Biological interpretation &amp; cell phenotyping", "Exercise 3: Spatial architecture of tumor microenvironment with SCIMAP", "Tissue domains with UTAG", "Spatial Proteomics: From Pixels to Phenotypes"], "terms": {"hand": [0, 1], "materi": 0, "analys": 0, "architectur": [0, 5], "tumour": [0, 3], "microenviron": [0, 2, 5], "us": [0, 1, 2, 3, 5], "multiplex": [0, 5], "tissu": [0, 2, 3, 5], "imag": [0, 1, 2, 3, 5], "python": [0, 5], "base": [0, 1, 2, 3, 4], "compil": 0, "jupyt": [0, 5], "book": 0, "open": [0, 1], "thi": [0, 1, 2, 4, 5], "introduc": 0, "comput": [0, 2, 5], "analysi": [0, 1, 3, 5], "from": [0, 1, 3, 4], "raw": [0, 1, 5], "protein": [0, 2, 3], "express": [0, 2], "biolog": [0, 5], "interpret": 0, "neighbourhood": [0, 5], "all": [0, 1, 3], "exercis": [0, 5], "real": 0, "high": [0, 1, 2, 3, 5], "grade": [0, 3], "serou": [0, 3], "ovarian": [0, 3], "cancer": [0, 1, 2, 3], "hgsoc": [0, 3], "tma": [0, 3], "topic": 0, "1": [0, 2, 4, 5], "technic": [0, 2, 3, 5], "foundat": 0, "digit": [0, 2], "patholog": 0, "2": [0, 1, 4, 5], "cell": [0, 1, 4, 5], "phenotyp": [0, 3, 4], "3": [0, 4, 5], "pip": 0, "instal": 0, "scimap": [0, 4, 5], "scanpi": [0, 3, 4], "anndata": [0, 3], "utag": [0, 5], "matplotlib": [0, 3, 4], "scikit": 0, "learn": 0, "purpos": [0, 3], "singl": 0, "handl": [0, 2], "unsupervis": [0, 4, 5], "domain": [0, 5], "discoveri": [0, 4, 5], "The": 0, "dataset": [0, 1, 2, 3, 4], "deriv": 0, "perez": [0, 3], "villatoro": [0, 3], "et": [0, 3], "al": [0, 3], "2025": 0, "http": 0, "doi": 0, "org": 0, "10": [0, 3], "1158": 0, "2159": 0, "8290": 0, "cd": 0, "25": 0, "1492": 0, "pleas": 0, "cite": 0, "origin": 0, "studi": [0, 3], "you": [0, 1, 2, 5], "your": [0, 1, 2, 3, 5], "own": [0, 3], "work": 0, "code": 0, "notebook": 0, "mit": 0, "written": 0, "content": 0, "cc": 0, "BY": 0, "4": [0, 5], "0": [0, 1, 3], "If": [0, 2, 3], "teach": [0, 3], "research": [0, 3], "farkkila": 0, "s": [0, 3, 4], "laboratori": 0, "github": 0, "link": 0, "In": [1, 3, 4, 5], "we": [1, 2, 3, 5], "aviv": [1, 5], "lightweight": 1, "web": [1, 5], "visual": [1, 3, 4, 5], "om": 1, "tiff": 1, "while": 1, "ar": [1, 2, 3], "tool": [1, 3, 5], "principl": 1, "contrast": [1, 5], "adjust": [1, 5], "appli": [1, 2, 3, 5], "major": [1, 3], "platform": 1, "like": [1, 3], "napari": 1, "qupath": 1, "fiji": 1, "launch": 1, "viewer": [1, 2, 5], "click": 1, "here": [1, 3], "lung": 1, "luca": 1, "7": [1, 3], "color": [1, 2, 3], "explor": [1, 5], "interfac": [1, 3, 5], "On": 1, "right": [1, 3], "side": [1, 3, 4], "see": 1, "control": 1, "ani": [1, 3], "expand": 1, "full": [1, 3], "list": [1, 3], "question": [1, 2], "how": [1, 2, 3], "mani": [1, 3], "present": [1, 3], "what": [1, 2, 5], "relationship": 1, "between": [1, 5], "nm": 1, "assign": 1, "answer": [1, 3], "There": 1, "includ": 1, "dapi": [1, 2], "usual": 1, "correspond": 1, "emiss": 1, "spectra": 1, "fluorophor": 1, "e": [1, 2, 3], "g": [1, 2, 3], "465nm": 1, "blue": [1, 3], "proteom": [1, 2, 3], "often": [1, 2], "ha": [1, 2, 3], "much": [1, 3], "wider": 1, "dynam": 1, "than": 1, "standard": [1, 3], "photo": 1, "toggl": [1, 2], "off": [1, 3], "except": 1, "one": [1, 2, 3], "slide": 1, "min": [1, 2, 5], "max": 1, "bar": [1, 2, 3], "three": 1, "dot": 1, "menu": 1, "next": [1, 3, 5], "select": 1, "maximum": 1, "valu": [1, 3], "visibl": [1, 3], "slider": 1, "when": [1, 2], "set": [1, 2], "hint": [1, 3], "8": [1, 3, 4], "256": 1, "16": [1, 3, 4], "65": 1, "536": 1, "onli": [1, 2, 3], "accur": 1, "hover": 1, "inspect": [1, 3], "move": [1, 3, 5], "mous": 1, "over": [1, 2], "bright": 1, "observ": [1, 2, 3], "chang": 1, "ui": 1, "zoom": [1, 2], "level": [1, 3], "scroll": 1, "until": 1, "individu": [1, 2, 3], "squar": [1, 3], "scale": [1, 2, 3, 5], "bottom": [1, 5], "physic": [1, 3], "mu": [1, 2], "m": [1, 2], "would": [1, 2, 3], "an": [1, 2, 3], "incorrect": 1, "affect": [1, 2], "calcul": [1, 3], "densiti": [1, 3], "distanc": [1, 5], "neighborhood": [1, 5], "activ": [1, 2, 3, 5], "6": 1, "pdl1": 1, "cd8": [1, 2], "foxp3": 1, "cd68": 1, "ck": 1, "custom": [1, 3], "creat": [1, 3], "snapshot": 1, "save": [1, 3], "As": 1, "take": [1, 3], "region": [1, 3, 5], "interest": [1, 3, 5], "roi": [1, 5], "critic": 1, "think": [1, 3], "trap": [1, 2, 3], "colleagu": 1, "png": 1, "jpg": 1, "downstream": [1, 2, 3], "quantif": 1, "instead": 1, "crop": 1, "result": [1, 3], "equival": 1, "explan": 1, "No": [1, 3, 4], "typic": [1, 2], "rgb": 1, "255": 1, "thei": [1, 2, 3], "compress": 1, "signal": [1, 3, 5], "bake": 1, "For": [1, 3, 5], "scienc": 1, "must": [1, 2, 3], "alwai": [1, 3], "quantifi": [1, 3, 5], "maintain": [1, 3], "linear": 1, "now": [2, 3], "ve": [2, 3], "master": [2, 5], "aspect": [2, 3], "view": 2, "skill": 2, "clinic": 2, "sampl": [2, 5], "specimen": 2, "via": 2, "cyclic": 2, "immunofluoresc": 2, "t": [2, 3], "cycif": [2, 5], "befor": 2, "can": [2, 3], "count": [2, 3], "them": [2, 3], "draw": 2, "boundari": [2, 3], "around": [2, 3], "everi": [2, 3], "nuclear": 2, "membran": 2, "cytoplasm": 2, "navig": [2, 5], "page": [2, 5], "tumor": [2, 5], "immun": [2, 3, 5], "label": [2, 3], "mask": 2, "outlin": 2, "repres": [2, 3, 5], "doe": 2, "algorithm": [2, 3], "larg": [2, 3], "sprawl": 2, "versu": 2, "small": [2, 3], "round": [2, 3], "lymphocyt": 2, "identifi": [2, 3, 4, 5], "error": 2, "area": 2, "where": [2, 3], "two": [2, 3], "merg": [2, 3], "under": 2, "split": [2, 3, 4], "bia": 2, "miss": 2, "captur": 2, "neighbor": 2, "mean": [2, 3, 5], "intens": [2, 3, 5], "A": [2, 3, 5], "ident": 2, "specif": [2, 3, 5], "combin": [2, 3], "switch": 2, "histolog": 2, "spatial": [2, 4], "allow": 2, "distinguish": [2, 5], "just": [2, 3], "look": [2, 3], "ratio": 2, "compar": [2, 3], "keratin": 2, "epitheli": [2, 3], "cd3": 2, "which": [2, 3, 5], "type": 2, "higher": [2, 3], "nucleu": 2, "estim": 2, "approxim": 2, "diamet": 2, "know": 2, "suppos": 2, "help": 2, "nois": 2, "categori": 2, "definit": 2, "exampl": [2, 3], "stain": [2, 5], "dna": [2, 3], "insid": [2, 3], "hoechst": 2, "main": 2, "bodi": 2, "cytoskeleton": 2, "alpha": [2, 3], "sma": 2, "outer": [2, 3], "skin": 2, "pd": [2, 3, 4], "l1": 2, "pure": [2, 3], "i": 2, "am": 2, "state": 2, "current": 2, "divid": 2, "locat": 2, "ki67": 2, "sinc": 2, "appear": [2, 3], "phase": 2, "cycl": 2, "why": 2, "cytotox": 2, "tab": 2, "dens": 2, "cluster": [2, 4, 5], "posit": [2, 3], "tightli": 2, "pack": 2, "overlap": 2, "border": [2, 3], "problem": 2, "touch": 2, "decid": 2, "end": [2, 3, 5], "other": [2, 3], "begin": [2, 5], "fals": [2, 3], "bleed": 2, "doesn": 2, "actual": [2, 3], "might": [2, 3], "lead": 2, "final": [2, 3], "finish": 2, "reflect": 2, "threshold": [2, 3], "too": [2, 3], "practic": 2, "lose": [2, 3], "weakli": 2, "impact": [2, 5], "our": [2, 3], "understand": [2, 3], "object": 3, "determin": 3, "whether": 3, "successfulli": 3, "infiltr": [3, 5], "get": 3, "most": [3, 4], "lethal": 3, "gynaecolog": 3, "becaus": 3, "patient": 3, "eventu": 3, "develop": 3, "resist": 3, "platinum": 3, "chemotherapi": 3, "treatment": 3, "strategi": 3, "exist": 3, "attract": 3, "veri": 3, "differ": [3, 5], "landscap": 3, "abbrevi": 3, "descript": 3, "primari": 3, "debulk": 3, "surgeri": 3, "first": [3, 5], "interv": 3, "id": 3, "shrink": 3, "also": 3, "stratifi": 3, "homolog": 3, "recombin": 3, "hr": 3, "statu": 3, "repair": 3, "capac": 3, "brcaloss": 3, "brca1": 3, "mutat": 3, "impair": 3, "make": 3, "more": 3, "sensit": 3, "certain": 3, "therapi": 3, "immunogen": 3, "hrp": 3, "profici": 3, "intact": 3, "gener": 3, "associ": 3, "poorer": 3, "immunotherapi": 3, "respons": 3, "2026": [3, 5], "genotyp": 3, "produc": 3, "strikingli": 3, "stroma": 3, "tsi": [3, 5], "zone": 3, "either": 3, "invad": 3, "block": 3, "core": [3, 4], "opposit": 3, "spectrum": 3, "group": 3, "84": [3, 4], "42": [3, 4], "detect": 3, "computation": 3, "coordin": 3, "By": [3, 5], "abl": [3, 5], "across": [3, 5], "section": 3, "build": 3, "proxim": [3, 5], "start": 3, "import": [3, 4], "librari": 3, "h5ad": [3, 4], "format": 3, "store": 3, "adata": [3, 4], "x": 3, "matrix": 3, "ob": [3, 4], "per": 3, "metadata": 3, "obsm": 3, "y": 3, "pixel": 3, "each": 3, "after": 3, "independ": 3, "process": 3, "sm": [3, 4], "sc": [3, 4], "ad": 3, "panda": [3, 4], "pyplot": [3, 4], "plt": [3, 4], "mcolor": 3, "read_h5ad": [3, 4], "single_cell_tma_dataset": 3, "tma8": [3, 4], "imageid": [3, 4], "tma_8_core84": [3, 4], "copi": [3, 4], "tma1": [3, 4], "tma_1_core42": [3, 4], "print": [3, 4], "f": [3, 4], "n_ob": [3, 4], "ndataset": 3, "schema": 3, "var_nam": 3, "column": [3, 4], "modulenotfounderror": [3, 4], "traceback": [3, 4], "recent": [3, 4], "call": [3, 4], "last": [3, 4], "line": [3, 4], "modul": [3, 4], "anyth": 3, "need": [3, 4], "intuit": 3, "atla": [3, 5], "both": 3, "serv": 3, "It": 3, "let": 3, "confirm": 3, "guid": 3, "write": 3, "plot": 3, "mai": 3, "few": 3, "second": 3, "marker_col": 3, "ck7": 3, "ecadherin": 3, "asma": 3, "vimentin": 3, "cd3d": 3, "cd11c": 3, "teal": 3, "dark": 3, "colormap": [3, 5], "custom_cmap": 3, "linearsegmentedcolormap": 3, "from_list": 3, "white_teal_dark": 3, "ffffff": 3, "508791": 3, "1d3033": 3, "pl": [3, 4], "spatial_scatterplot": [3, 4], "colorbi": [3, 4], "ncol": 3, "figsiz": [3, 4], "12": [3, 4], "cmap": 3, "plotlegend": 3, "true": 3, "ngener": 3, "role": 3, "cytokeratin": 3, "filament": 3, "delin": 3, "nest": [3, 5], "cadherin": 3, "calcium": 3, "depend": 3, "adhes": 3, "molecul": 3, "integr": 3, "\u03b1sma": 3, "stromal": [3, 5], "fibroblast": 3, "actin": 3, "isoform": 3, "mesenchym": 3, "intermedi": 3, "broadli": 3, "mark": 3, "non": 3, "lymphoid": 3, "compon": 3, "receptor": 3, "complex": 3, "myeloid": 3, "dendrit": 3, "integrin": 3, "dc": 3, "macrophag": 3, "consid": 3, "show": 3, "clearli": 3, "distinct": 3, "diffus": 3, "alon": 3, "do": 3, "expect": 3, "easi": 3, "vs": 3, "challeng": 3, "neg": 3, "similar": 3, "term": 3, "distribut": 3, "seen": 3, "recognis": 3, "presenc": 3, "po": 3, "absenc": 3, "nan": 3, "requir": 3, "AND": 3, "fill": 3, "none": 3, "below": 3, "leav": 3, "should": 3, "absent": 3, "irrelev": 3, "order": 3, "global": 3, "todo": 3, "replac": 3, "ecad": 3, "vim": 3, "datafram": 3, "csv": 3, "input": 3, "phenotype_workflow": 3, "to_str": 3, "index": 3, "reus": 3, "to_csv": 3, "With": 3, "rescal": 3, "within": [3, 5], "correct": 3, "batch": 3, "effect": 3, "logic": 3, "so": 3, "pp": 3, "gate": 3, "complet": 3, "classifi": 3, "read_csv": 3, "tl": [3, 4], "phenotype_cel": 3, "checkpoint": 3, "were": 3, "value_count": 3, "n": 3, "never": 3, "skip": 3, "qc": 3, "autom": [3, 5], "verifi": 3, "sens": 3, "complementari": 3, "check": [3, 5], "heatmap": 3, "row": 3, "light": 3, "up": 3, "unexpect": 3, "refin": 3, "b": 3, "scatter": 3, "overlai": 3, "back": 3, "onto": 3, "anatom": 3, "form": 3, "coher": 3, "randomli": 3, "groupbi": 3, "subsetmark": 3, "examin": 3, "abov": 3, "unexpectedli": 3, "target": 3, "caus": 3, "choic": 3, "about": 3, "low": 3, "tell": 3, "clean": 3, "confid": 3, "subcategori": 3, "unknown": 3, "These": 3, "partial": 3, "match": 3, "don": 3, "meet": 3, "criteria": 3, "re": 3, "nupdat": 3, "heart": 3, "its": 3, "nearest": 3, "neighbour": 3, "left": 3, "shift": 3, "peak": 3, "short": 3, "close": 3, "consist": 3, "longer": 3, "suggest": 3, "exclud": 3, "greater": 3, "colour": 3, "palett": 3, "celltype_color": 3, "d33f49": 3, "red": 3, "fed18c": 3, "peach": 3, "6599cd": 3, "d9dee4": 3, "grei": 3, "comparison": [3, 4], "concat": 3, "join": 3, "core84": 3, "core42": 3, "pairwis": 3, "spatial_dist": 3, "total": 3, "uniqu": 3, "numer": 3, "median": 3, "give": 3, "quick": 3, "method": 3, "distance_from": 3, "log": 3, "height": 3, "11": 3, "diagnost": 3, "exclus": 3, "distance_to": 3, "a7aef2": 3, "contact": 3, "gap": 3, "pronounc": 3, "hump": 3, "enter": 3, "inflam": 3, "desert": 3, "did": 3, "explain": [3, 5], "far": 3, "But": 3, "pattern": [3, 5], "co": 3, "occur": 3, "live": 3, "radiu": 3, "r": 3, "k": [3, 5], "profil": 3, "local": 3, "environ": [3, 5], "domin": 3, "rich": 3, "mix": 3, "down": 3, "remov": 3, "ambigu": 3, "cleaner": 3, "adata_known": 3, "retain": 3, "breakdown": 3, "50": 3, "decis": 3, "noisi": 3, "structur": 3, "spatial_count": 3, "elbow": 3, "choos": 3, "inertia": 3, "sum": 3, "centr": 3, "decreas": 3, "slowli": 3, "good": 3, "curv": 3, "bend": 3, "sharpli": 3, "beyond": [3, 5], "point": 3, "diminish": 3, "return": 3, "sklearn": 3, "kmean": 3, "extract": 3, "neighbor_data": 3, "un": 3, "record": 3, "k_rang": 3, "rang": [3, 5], "km": 3, "n_cluster": 3, "random_st": 3, "n_init": 3, "fit": 3, "append": 3, "inertia_": 3, "fig": 3, "ax": 3, "subplot": 3, "o": 3, "linewidth": 3, "markers": 3, "set_xlabel": 3, "fontsiz": 3, "13": 3, "set_ylabel": 3, "set_titl": 3, "14": 3, "axvlin": 3, "linestyl": 3, "chosen": 3, "legend": 3, "tight_layout": 3, "nbase": 3, "reason": 3, "togeth": 3, "ensur": 3, "spatial_clust": 3, "composit": 3, "stack": [3, 5], "barplot": 3, "retriev": 3, "underli": 3, "tempfil": 3, "temporarydirectori": 3, "tmpdir": 3, "df_84": 3, "stacked_barplot": 3, "x_axi": 3, "y_axi": 3, "return_data": 3, "savedir": 3, "filenam": 3, "tmp": 3, "pdf": 3, "df_42": 3, "manual": 3, "ax1": 3, "ax2": 3, "sharei": 3, "kind": 3, "proport": 3, "tick_param": 3, "axi": 3, "rotat": 3, "titl": [3, 4], "bbox_to_anchor": 3, "05": 3, "loc": 3, "upper": 3, "suptitl": 3, "15": [3, 5], "02": 3, "detail": 3, "templat": 3, "updat": 3, "rcn_name": 3, "dictionari": 3, "output": 3, "string": 3, "nich": 3, "solid": 3, "add": 3, "new": 3, "readabl": 3, "preserv": 3, "spatial_commun": [3, 4], "astyp": 3, "str": 3, "commun": 3, "community_palett": 3, "dc19dc": 3, "magenta": 3, "fa3232": 3, "lavend": 3, "customcolor": 3, "nrcn": 3, "proportion": 3, "larger": 3, "relat": [3, 5], "doubl": 3, "100": 3, "happen": 3, "becom": 3, "less": 3, "pipelin": 3, "built": 3, "valid": 3, "everyth": 3, "same": 3, "have": 3, "relev": 3, "rel": 3, "saniti": 3, "paramet": [3, 5], "extend": 3, "some": 3, "follow": 3, "resourc": 3, "document": 3, "load": 4, "scimap_processed_single_cell_tma_dataset": 4, "data": [4, 5], "name": 4, "run": [4, 5], "cluster_kei": 4, "renam": 4, "simpli": 4, "utag_clust": 4, "welcom": 5, "session": 5, "simpl": 5, "microscopi": 5, "dimension": 5, "manag": 5, "translat": 5, "fluoresc": 5, "softwar": 5, "directli": 5, "browser": 5, "initi": 5, "evalu": 5, "channel": 5, "highlight": 5, "assess": 5, "qualiti": 5, "bit": 5, "depth": 5, "micron": 5, "aggreg": 5, "morpholog": 5, "lineag": 5, "function": 5, "marker": 5, "measur": 5, "social": 5, "map": 5, "recurr": 5, "cellular": 5, "rcn": 5, "durat": 5, "focu": 5, "intro": 5, "setup": 5, "5": 5, "access": 5, "20": 5, "export": 5, "discuss": 5, "q": 5, "60": 5, "readi": 5, "sidebar": 5, "button": 5}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"spatial": [0, 1, 3, 5], "proteom": [0, 5], "workshop": [0, 5], "2026": 0, "overview": [0, 3], "tool": 0, "depend": 0, "data": [0, 1, 2, 3], "licens": 0, "citat": 0, "exercis": [1, 2, 3], "1": [1, 3], "technic": 1, "foundat": 1, "digit": 1, "patholog": 1, "get": 1, "start": 1, "understand": 1, "multiplex": 1, "channel": 1, "task": [1, 2, 3], "count": 1, "avail": 1, "look": 1, "metadata": 1, "wavelength": 1, "name": [1, 3], "intens": 1, "rang": 1, "bit": 1, "depth": 1, "discoveri": 1, "pixel": [1, 2, 5], "vs": [1, 2], "micron": 1, "why": [1, 3], "doe": [1, 3], "size": 1, "matter": [1, 3], "composit": 1, "integr": 1, "2": [2, 3], "biolog": [2, 3], "interpret": [2, 3], "cell": [2, 3], "phenotyp": [2, 5], "from": [2, 5], "segment": 2, "open": 2, "lung": 2, "3": [2, 3], "process": 2, "tour": 2, "defin": [2, 3], "morpholog": 2, "lineag": 2, "subcellular": 2, "local": 2, "function": 2, "marker": [2, 3], "The": [2, 3], "real": 2, "world": 2, "challeng": 2, "signal": 2, "aggreg": 2, "bonu": 2, "headach": 2, "summari": [2, 3], "find": [2, 3], "architectur": 3, "tumor": 3, "microenviron": 3, "scimap": 3, "clinic": 3, "context": 3, "what": 3, "you": 3, "Will": 3, "discov": 3, "learn": [3, 5], "outcom": 3, "workflow": 3, "step": 3, "load": 3, "visualis": 3, "raw": 3, "express": 3, "refer": 3, "tabl": 3, "question": 3, "ident": 3, "rule": 3, "run": 3, "classif": 3, "4": 3, "qualiti": 3, "control": 3, "5": 3, "measur": 3, "social": 3, "distanc": 3, "between": 3, "type": 3, "thi": 3, "befor": 3, "code": 3, "6": 3, "map": 3, "recurr": 3, "neighbourhood": 3, "rcn": 3, "approach": 3, "three": 3, "predict": 3, "comput": 3, "optim": 3, "number": 3, "assign": 3, "cluster": 3, "conclus": 3, "kei": 3, "takeawai": 3, "go": 3, "further": 3, "tissu": 4, "domain": 4, "utag": 4, "object": 5, "schedul": 5}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})